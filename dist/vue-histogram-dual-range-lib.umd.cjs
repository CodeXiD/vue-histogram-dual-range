(function(t,w){typeof exports=="object"&&typeof module<"u"?module.exports=w(require("vue")):typeof define=="function"&&define.amd?define(["vue"],w):(t=typeof globalThis<"u"?globalThis:t||self,t.VueHistogramDualRangeLibrary=w(t.Vue))})(this,function(t){"use strict";function w(e){return t.getCurrentScope()?(t.onScopeDispose(e),!0):!1}function u(e,r){return r==null?t.unref(e):t.unref(e)[r]}function A(e){return typeof e=="function"?e():t.unref(e)}const q=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const I=e=>typeof e<"u",D=e=>e!=null,R=()=>{};function M(e,r){function a(...n){return new Promise((s,o)=>{Promise.resolve(e(()=>r.apply(this,n),{fn:r,thisArg:this,args:n})).then(s).catch(o)})}return a}const F=e=>e();function z(...e){if(e.length===2){const[r,a]=e;r.value=a}if(e.length===3){const[r,a,n]=e;r[a]=n}}function W(e,r={}){const{method:a="parseFloat",radix:n,nanToZero:s}=r;return t.computed(()=>{let o=A(e);return typeof o=="string"&&(o=Number[a](o,n)),s&&Number.isNaN(o)&&(o=0),o})}function O(e,r,a={}){const{eventFilter:n=F,...s}=a,o=M(n,r);let g,c,l;if(s.flush==="sync"){const d=t.ref(!1);c=()=>{},g=i=>{d.value=!0,i(),d.value=!1},l=t.watch(e,(...i)=>{d.value||o(...i)},s)}else{const d=[],i=t.ref(0),f=t.ref(0);c=()=>{i.value=f.value},d.push(t.watch(e,()=>{f.value++},{...s,flush:"sync"})),g=b=>{const y=f.value;b(),i.value+=f.value-y},d.push(t.watch(e,(...b)=>{const y=i.value>0&&i.value===f.value;i.value=0,f.value=0,!y&&o(...b)},s)),l=()=>{d.forEach(b=>b())}}return{stop:l,ignoreUpdates:g,ignorePrevAsyncUpdates:c}}function P(e,r,a={}){let n;function s(){if(!n)return;const i=n;n=void 0,i()}function o(i){n=i}const g=(i,f)=>(s(),r(i,f,o)),c=O(e,g,a),{ignoreUpdates:l}=c;return{...c,trigger:()=>{let i;return l(()=>{i=g(_(e),T(e))}),i}}}function _(e){return t.isReactive(e)?e:Array.isArray(e)?e.map(r=>A(r)):A(e)}function T(e){return Array.isArray(e)?e.map(()=>{}):void 0}function H(e){var r;const a=A(e);return(r=a==null?void 0:a.$el)!=null?r:a}const E=q?window:void 0;function U(){const e=t.ref(!1),r=t.getCurrentInstance();return r&&t.onMounted(()=>{e.value=!0},r),e}function $(e){const r=U();return t.computed(()=>(r.value,!!e()))}function J(e){return JSON.parse(JSON.stringify(e))}function G(e,r,a={}){const{window:n=E,...s}=a;let o;const g=$(()=>n&&"ResizeObserver"in n),c=()=>{o&&(o.disconnect(),o=void 0)},l=t.computed(()=>Array.isArray(e)?e.map(f=>H(f)):[H(e)]),d=t.watch(l,f=>{if(c(),g.value&&n){o=new ResizeObserver(r);for(const b of f)b&&o.observe(b,s)}},{immediate:!0,flush:"post"}),i=()=>{c(),d()};return w(i),{isSupported:g,stop:i}}function L(e,r,a={}){const{root:n,rootMargin:s="0px",threshold:o=.1,window:g=E,immediate:c=!0}=a,l=$(()=>g&&"IntersectionObserver"in g),d=t.computed(()=>{const V=A(e);return(Array.isArray(V)?V:[V]).map(H).filter(D)});let i=R;const f=t.ref(c),b=l.value?t.watch(()=>[d.value,H(n),f.value],([V,x])=>{if(i(),!f.value||!V.length)return;const p=new IntersectionObserver(r,{root:H(x),rootMargin:s,threshold:o});V.forEach(v=>v&&p.observe(v)),i=()=>{p.disconnect(),i=R}},{immediate:c,flush:"post"}):R,y=()=>{i(),b(),f.value=!1};return w(y),{isSupported:l,isActive:f,pause(){i(),f.value=!1},resume(){f.value=!0},stop:y}}function k(e,r,a,n={}){var s,o,g;const{clone:c=!1,passive:l=!1,eventName:d,deep:i=!1,defaultValue:f,shouldEmit:b}=n,y=t.getCurrentInstance(),V=a||(y==null?void 0:y.emit)||((s=y==null?void 0:y.$emit)==null?void 0:s.bind(y))||((g=(o=y==null?void 0:y.proxy)==null?void 0:o.$emit)==null?void 0:g.bind(y==null?void 0:y.proxy));let x=d;x=x||`update:${r.toString()}`;const p=m=>c?typeof c=="function"?c(m):J(m):m,v=()=>I(e[r])?p(e[r]):f,N=m=>{b?b(m)&&V(x,m):V(x,m)};if(l){const m=v(),C=t.ref(m);let h=!1;return t.watch(()=>e[r],S=>{h||(h=!0,C.value=p(S),t.nextTick(()=>h=!1))}),t.watch(C,S=>{!h&&(S!==e[r]||i)&&N(S)},{deep:i}),C}else return t.computed({get(){return v()},set(m){N(m)}})}const j=e=>(t.pushScopeId("data-v-f556e555"),e=e(),t.popScopeId(),e),Z={class:"sliders-control"},K=j(()=>t.createElementVNode("div",{class:"slider-track"},null,-1)),Q=["value","min","max"],X=["value","min","max"],Y=t.defineComponent({__name:"DoubleRangeSlider",props:{modelValue:{type:Array,default:()=>[0,100]},min:{type:Number,default:0},max:{type:Number,default:100},sliderColor:{type:String,required:!0},sliderBorderColor:{type:String,required:!0},sliderHoverColor:{type:String,required:!0},sliderSize:{type:Number,required:!0},rangeColor:{type:String,required:!0},rangeActiveColor:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:r}){const a=r,n=e,{sliderColor:s,rangeColor:o,rangeActiveColor:g,min:c,max:l}=t.toRefs(n),d=k(n,"modelValue",a),i=([m,C])=>{let h=m,S=C;return h>=S&&(h=S-1),S<=h&&(S=h+1),(h<u(c)||h>u(l))&&(h=u(c)),(S>u(l)||S<u(c))&&(S=u(l)),[h,S]},{ignoreUpdates:f,stop:b}=O(d,(m,C)=>{m[0]===C[0]&&m[1]===C[1]||z(d,i(m))});t.onUnmounted(()=>{b()});const y=t.ref(),V=t.ref(),x=t.ref(),p=m=>{let C=parseInt(m.target.value,10);const h=u(d)[1];f(()=>{z(d,i([C,h]))})},v=m=>{const C=u(d)[0];let h=parseInt(m.target.value,10);f(()=>{z(d,i([C,h]))})},N=t.computed(()=>{const m=u(d)[0]/u(l)*100,C=u(d)[1]/u(l)*100;return`linear-gradient(to right, ${u(o)} ${m}%, ${u(g)} ${m}%, ${u(g)} ${C}%, ${u(o)} ${C}%)`});return(m,C)=>(t.openBlock(),t.createElementBlock("div",{class:"double-range-slider",style:t.normalizeStyle({"--sliderColor":t.unref(s),"--sliderBorderColor":e.sliderBorderColor,"--sliderHoverColor":e.sliderHoverColor,"--sliderSize":e.sliderSize,"--rangeColor":t.unref(o),"--rangeActiveColor":t.unref(g),"--rangeFillBg":N.value})},[t.createElementVNode("div",Z,[K,t.createElementVNode("input",{ref_key:"fromSliderRef",ref:y,class:"fromSlider",type:"range",value:t.unref(d)[0],min:t.unref(c),max:t.unref(l),onInput:p},null,40,Q),t.createElementVNode("input",{ref_key:"toSliderRef",ref:V,class:"toSlider",type:"range",value:t.unref(d)[1],min:t.unref(c),max:t.unref(l),style:t.normalizeStyle({background:x.value}),onInput:v},null,44,X)])],4))}}),B=(e,r)=>{const a=e.__vccOpts||e;for(const[n,s]of r)a[n]=s;return a},ee=B(Y,[["__scopeId","data-v-f556e555"]]);function te({histogramDataMap:e,step:r,min:a,max:n}){const s=[];for(let o=a;o<=n;o+=r){let g=0,c=0;for(let l=o;l<o+r&&l<=n;l++)e.has(l)&&(g+=e.get(l),c++);c>0?s.push(Number((g/c).toFixed(2))):s.push(0)}return s}const re=["x","width","height","fill"],oe=B(t.defineComponent({__name:"Histogram",props:{histogramData:{type:Array,default:()=>[0,100]},histogramHeight:{type:Number,default:83},histogramColumnCount:{type:Number,required:!0},histogramColumnAverages:{type:Array,required:!0},min:{type:Number,required:!0},max:{type:Number,required:!0},histogramColumnColor:{type:String,required:!0},histogramColumnOffset:{type:Number,required:!0},sliderSize:{type:Number,required:!0}},setup(e){const r=e,{histogramData:a,min:n,max:s,histogramColumnCount:o,histogramColumnOffset:g,histogramColumnAverages:c}=t.toRefs(r),l=t.ref(),d=t.ref(0),i=P(l,()=>{var p;z(d,(p=u(l))==null?void 0:p.clientWidth)}),f=t.computed(()=>{const p=u(d);return p?u(W((p/u(o)-u(g)).toFixed(2))):0}),b=G(l,()=>{i.trigger()}),y=L(l,([{isIntersecting:p}])=>{p&&i.trigger()});t.onUnmounted(()=>{b.stop(),y.stop()});const V=t.computed(()=>{let p=new Map;return u(a).forEach(v=>{p.set(v.value,v.count)}),p}),x=t.computed(()=>{const p=Math.ceil(u(s)/u(o)),v=u(c)?u(c):te({histogramDataMap:u(V),step:p,min:u(n),max:u(s)}),N=Math.max.apply(Math,v);return v.map(C=>C/N*100).map((C,h)=>{let S=0;return h>0&&(S=u(f)*h+h*u(g)),{heightPercentage:C,x:S}})});return(p,v)=>(t.openBlock(),t.createElementBlock("div",{class:"histogram",style:t.normalizeStyle({"--sliderSize":e.sliderSize})},[(t.openBlock(),t.createElementBlock("svg",{ref_key:"svgHistogramRef",ref:l,style:t.normalizeStyle({height:`${e.histogramHeight}px`}),xmlns:"http://www.w3.org/2000/svg"},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(x.value,(N,m)=>(t.openBlock(),t.createElementBlock("rect",{key:m,x:N.x,y:"0",width:f.value,height:`${N.heightPercentage}%`,fill:e.histogramColumnColor},null,8,re))),128))],4))],4))}}),[["__scopeId","data-v-4b5ad2b5"]]),ne={class:"histogram-range-container"};return B(t.defineComponent({__name:"VueHistogramDualRange",props:{modelValue:{type:Array,default:()=>[0,100]},min:{type:Number,default:0},max:{type:Number,default:100},histogramData:{type:Array,default:()=>[]},histogramColumnCount:{type:Number,default:17},histogramColumnAverages:{type:Array,default:null},histogramHeight:{type:Number,default:83},histogramColumnColor:{type:String,default:"#a3bbff"},histogramColumnOffset:{type:Number,default:5},sliderColor:{type:String,default:"#3264fe"},sliderBorderColor:{type:String,default:"#577cec"},sliderHoverColor:{type:String,default:"#577cec"},sliderSize:{type:Number,default:20},rangeColor:{type:String,default:"#dadae5"},rangeActiveColor:{type:String,default:"#3264fe"}},emits:["update:modelValue"],setup(e,{emit:r}){const a=r,n=e,s=k(n,"modelValue",a),o=t.computed(()=>n.histogramColumnCount<=n.max?n.histogramColumnCount:n.max);return(g,c)=>(t.openBlock(),t.createElementBlock("div",ne,[t.createVNode(oe,{"histogram-data":e.histogramData,"histogram-height":e.histogramHeight,"histogram-column-count":o.value,"histogram-column-averages":e.histogramColumnAverages,max:e.max,min:e.min,"histogram-column-color":e.histogramColumnColor,"histogram-column-offset":e.histogramColumnOffset,"slider-size":e.sliderSize},null,8,["histogram-data","histogram-height","histogram-column-count","histogram-column-averages","max","min","histogram-column-color","histogram-column-offset","slider-size"]),t.createVNode(ee,{modelValue:t.unref(s),"onUpdate:modelValue":c[0]||(c[0]=l=>t.isRef(s)?s.value=l:null),min:e.min,max:e.max,"slider-color":e.sliderColor,"slider-border-color":e.sliderBorderColor,"slider-hover-color":e.sliderHoverColor,"slider-size":e.sliderSize,"range-color":e.rangeColor,"range-active-color":e.rangeActiveColor},null,8,["modelValue","min","max","slider-color","slider-border-color","slider-hover-color","slider-size","range-color","range-active-color"])]))}}),[["__scopeId","data-v-75c20065"]])});
