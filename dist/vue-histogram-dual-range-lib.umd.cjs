(function(t,w){typeof exports=="object"&&typeof module<"u"?module.exports=w(require("vue")):typeof define=="function"&&define.amd?define(["vue"],w):(t=typeof globalThis<"u"?globalThis:t||self,t.VueHistogramDualRangeLibrary=w(t.Vue))})(this,function(t){"use strict";function w(e){return t.getCurrentScope()?(t.onScopeDispose(e),!0):!1}function u(e,r){return r==null?t.unref(e):t.unref(e)[r]}function A(e){return typeof e=="function"?e():t.unref(e)}const I=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const q=e=>typeof e<"u",D=e=>e!=null,R=()=>{};function M(e,r){function s(...n){return new Promise((a,o)=>{Promise.resolve(e(()=>r.apply(this,n),{fn:r,thisArg:this,args:n})).then(a).catch(o)})}return s}const F=e=>e();function z(...e){if(e.length===2){const[r,s]=e;r.value=s}if(e.length===3){const[r,s,n]=e;r[s]=n}}function W(e,r={}){const{method:s="parseFloat",radix:n,nanToZero:a}=r;return t.computed(()=>{let o=A(e);return typeof o=="string"&&(o=Number[s](o,n)),a&&Number.isNaN(o)&&(o=0),o})}function O(e,r,s={}){const{eventFilter:n=F,...a}=s,o=M(n,r);let f,l,c;if(a.flush==="sync"){const m=t.ref(!1);l=()=>{},f=i=>{m.value=!0,i(),m.value=!1},c=t.watch(e,(...i)=>{m.value||o(...i)},a)}else{const m=[],i=t.ref(0),g=t.ref(0);l=()=>{i.value=g.value},m.push(t.watch(e,()=>{g.value++},{...a,flush:"sync"})),f=b=>{const y=g.value;b(),i.value+=g.value-y},m.push(t.watch(e,(...b)=>{const y=i.value>0&&i.value===g.value;i.value=0,g.value=0,!y&&o(...b)},a)),c=()=>{m.forEach(b=>b())}}return{stop:c,ignoreUpdates:f,ignorePrevAsyncUpdates:l}}function _(e,r,s={}){let n;function a(){if(!n)return;const i=n;n=void 0,i()}function o(i){n=i}const f=(i,g)=>(a(),r(i,g,o)),l=O(e,f,s),{ignoreUpdates:c}=l;return{...l,trigger:()=>{let i;return c(()=>{i=f(P(e),T(e))}),i}}}function P(e){return t.isReactive(e)?e:Array.isArray(e)?e.map(r=>A(r)):A(e)}function T(e){return Array.isArray(e)?e.map(()=>{}):void 0}function H(e){var r;const s=A(e);return(r=s==null?void 0:s.$el)!=null?r:s}const E=I?window:void 0;function U(){const e=t.ref(!1),r=t.getCurrentInstance();return r&&t.onMounted(()=>{e.value=!0},r),e}function $(e){const r=U();return t.computed(()=>(r.value,!!e()))}function J(e){return JSON.parse(JSON.stringify(e))}function G(e,r,s={}){const{window:n=E,...a}=s;let o;const f=$(()=>n&&"ResizeObserver"in n),l=()=>{o&&(o.disconnect(),o=void 0)},c=t.computed(()=>Array.isArray(e)?e.map(g=>H(g)):[H(e)]),m=t.watch(c,g=>{if(l(),f.value&&n){o=new ResizeObserver(r);for(const b of g)b&&o.observe(b,a)}},{immediate:!0,flush:"post"}),i=()=>{l(),m()};return w(i),{isSupported:f,stop:i}}function L(e,r,s={}){const{root:n,rootMargin:a="0px",threshold:o=.1,window:f=E,immediate:l=!0}=s,c=$(()=>f&&"IntersectionObserver"in f),m=t.computed(()=>{const V=A(e);return(Array.isArray(V)?V:[V]).map(H).filter(D)});let i=R;const g=t.ref(l),b=c.value?t.watch(()=>[m.value,H(n),g.value],([V,p])=>{if(i(),!g.value||!V.length)return;const S=new IntersectionObserver(r,{root:H(p),rootMargin:a,threshold:o});V.forEach(v=>v&&S.observe(v)),i=()=>{S.disconnect(),i=R}},{immediate:l,flush:"post"}):R,y=()=>{i(),b(),g.value=!1};return w(y),{isSupported:c,isActive:g,pause(){i(),g.value=!1},resume(){g.value=!0},stop:y}}function k(e,r,s,n={}){var a,o,f;const{clone:l=!1,passive:c=!1,eventName:m,deep:i=!1,defaultValue:g,shouldEmit:b}=n,y=t.getCurrentInstance(),V=s||(y==null?void 0:y.emit)||((a=y==null?void 0:y.$emit)==null?void 0:a.bind(y))||((f=(o=y==null?void 0:y.proxy)==null?void 0:o.$emit)==null?void 0:f.bind(y==null?void 0:y.proxy));let p=m;p=p||`update:${r.toString()}`;const S=d=>l?typeof l=="function"?l(d):J(d):d,v=()=>q(e[r])?S(e[r]):g,N=d=>{b?b(d)&&V(p,d):V(p,d)};if(c){const d=v(),C=t.ref(d);let h=!1;return t.watch(()=>e[r],x=>{h||(h=!0,C.value=S(x),t.nextTick(()=>h=!1))}),t.watch(C,x=>{!h&&(x!==e[r]||i)&&N(x)},{deep:i}),C}else return t.computed({get(){return v()},set(d){N(d)}})}const j=e=>(t.pushScopeId("data-v-f556e555"),e=e(),t.popScopeId(),e),Z={class:"sliders-control"},K=j(()=>t.createElementVNode("div",{class:"slider-track"},null,-1)),Q=["value","min","max"],X=["value","min","max"],Y=t.defineComponent({__name:"DoubleRangeSlider",props:{modelValue:{type:Array,default:()=>[0,100]},min:{type:Number,default:0},max:{type:Number,default:100},sliderColor:{type:String,required:!0},sliderBorderColor:{type:String,required:!0},sliderHoverColor:{type:String,required:!0},sliderSize:{type:Number,required:!0},rangeColor:{type:String,required:!0},rangeActiveColor:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:r}){const s=r,n=e,{sliderColor:a,rangeColor:o,rangeActiveColor:f,min:l,max:c}=t.toRefs(n),m=k(n,"modelValue",s),i=([d,C])=>{let h=d,x=C;return h>=x&&(h=x-1),x<=h&&(x=h+1),(h<u(l)||h>u(c))&&(h=u(l)),(x>u(c)||x<u(l))&&(x=u(c)),[h,x]},{ignoreUpdates:g,stop:b}=O(m,(d,C)=>{d[0]===C[0]&&d[1]===C[1]||z(m,i(d))});t.onUnmounted(()=>{b()});const y=t.ref(),V=t.ref(),p=t.ref(),S=d=>{let C=parseInt(d.target.value,10);const h=u(m)[1];g(()=>{z(m,i([C,h]))})},v=d=>{const C=u(m)[0];let h=parseInt(d.target.value,10);g(()=>{z(m,i([C,h]))})},N=t.computed(()=>{const d=u(m)[0]/u(c)*100,C=u(m)[1]/u(c)*100;return`linear-gradient(to right, ${u(o)} ${d}%, ${u(f)} ${d}%, ${u(f)} ${C}%, ${u(o)} ${C}%)`});return(d,C)=>(t.openBlock(),t.createElementBlock("div",{class:"double-range-slider",style:t.normalizeStyle({"--sliderColor":t.unref(a),"--sliderBorderColor":e.sliderBorderColor,"--sliderHoverColor":e.sliderHoverColor,"--sliderSize":e.sliderSize,"--rangeColor":t.unref(o),"--rangeActiveColor":t.unref(f),"--rangeFillBg":N.value})},[t.createElementVNode("div",Z,[K,t.createElementVNode("input",{ref_key:"fromSliderRef",ref:y,class:"fromSlider",type:"range",value:t.unref(m)[0],min:t.unref(l),max:t.unref(c),onInput:S},null,40,Q),t.createElementVNode("input",{ref_key:"toSliderRef",ref:V,class:"toSlider",type:"range",value:t.unref(m)[1],min:t.unref(l),max:t.unref(c),style:t.normalizeStyle({background:p.value}),onInput:v},null,44,X)])],4))}}),B=(e,r)=>{const s=e.__vccOpts||e;for(const[n,a]of r)s[n]=a;return s},ee=B(Y,[["__scopeId","data-v-f556e555"]]);function te({histogramDataMap:e,step:r,min:s,max:n}){const a=[];for(let o=s;o<=n;o+=r){let f=0,l=0;for(let c=o;c<o+r&&c<=n;c++)e.has(c)&&(f+=e.get(c),l++);l>0?a.push(Number((f/l).toFixed(2))):a.push(0)}return a}const re=["x","width","height","fill"],oe=B(t.defineComponent({__name:"Histogram",props:{histogramData:{type:Array,default:()=>[0,100]},histogramHeight:{type:Number,default:83},histogramColumnCount:{type:Number,required:!0},min:{type:Number,required:!0},max:{type:Number,required:!0},histogramColumnColor:{type:String,required:!0},histogramColumnOffset:{type:Number,required:!0},sliderSize:{type:Number,required:!0}},setup(e){const r=e,{histogramData:s,min:n,max:a,histogramColumnCount:o,histogramColumnOffset:f}=t.toRefs(r),l=t.ref(),c=t.ref(0),m=_(l,()=>{var p;z(c,(p=u(l))==null?void 0:p.clientWidth)}),i=t.computed(()=>{const p=u(c);return p?u(W((p/u(o)-u(f)).toFixed(2))):0}),g=G(l,()=>{m.trigger()}),b=L(l,([{isIntersecting:p}])=>{p&&m.trigger()});t.onUnmounted(()=>{g.stop(),b.stop()});const y=t.computed(()=>{let p=new Map;return u(s).forEach(S=>{p.set(S.value,S.count)}),p}),V=t.computed(()=>{const p=Math.ceil(u(a)/u(o)),S=te({histogramDataMap:u(y),step:p,min:u(n),max:u(a)}),v=Math.max.apply(Math,S);return S.map(d=>d/v*100).map((d,C)=>{let h=0;return C>0&&(h=u(i)*C+C*u(f)),{heightPercentage:d,x:h}})});return(p,S)=>(t.openBlock(),t.createElementBlock("div",{class:"histogram",style:t.normalizeStyle({"--sliderSize":e.sliderSize})},[(t.openBlock(),t.createElementBlock("svg",{ref_key:"svgHistogramRef",ref:l,style:t.normalizeStyle({height:`${e.histogramHeight}px`}),xmlns:"http://www.w3.org/2000/svg"},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(V.value,(v,N)=>(t.openBlock(),t.createElementBlock("rect",{key:N,x:v.x,y:"0",width:i.value,height:`${v.heightPercentage}%`,fill:e.histogramColumnColor},null,8,re))),128))],4))],4))}}),[["__scopeId","data-v-994b0234"]]),ne={class:"histogram-range-container"};return B(t.defineComponent({__name:"VueHistogramDualRange",props:{modelValue:{type:Array,default:()=>[0,100]},min:{type:Number,default:0},max:{type:Number,default:100},histogramData:{type:Array,default:()=>[]},histogramColumnCount:{type:Number,default:17},histogramHeight:{type:Number,default:83},histogramColumnColor:{type:String,default:"#a3bbff"},histogramColumnOffset:{type:Number,default:5},sliderColor:{type:String,default:"#3264fe"},sliderBorderColor:{type:String,default:"#577cec"},sliderHoverColor:{type:String,default:"#577cec"},sliderSize:{type:Number,default:20},rangeColor:{type:String,default:"#dadae5"},rangeActiveColor:{type:String,default:"#3264fe"}},emits:["update:modelValue"],setup(e,{emit:r}){const s=r,n=e,a=k(n,"modelValue",s),o=t.computed(()=>n.histogramColumnCount<=n.max?n.histogramColumnCount:n.max);return(f,l)=>(t.openBlock(),t.createElementBlock("div",ne,[t.createVNode(oe,{"histogram-data":e.histogramData,"histogram-height":e.histogramHeight,"histogram-column-count":o.value,max:e.max,min:e.min,"histogram-column-color":e.histogramColumnColor,"histogram-column-offset":e.histogramColumnOffset,"slider-size":e.sliderSize},null,8,["histogram-data","histogram-height","histogram-column-count","max","min","histogram-column-color","histogram-column-offset","slider-size"]),t.createVNode(ee,{modelValue:t.unref(a),"onUpdate:modelValue":l[0]||(l[0]=c=>t.isRef(a)?a.value=c:null),min:e.min,max:e.max,"slider-color":e.sliderColor,"slider-border-color":e.sliderBorderColor,"slider-hover-color":e.sliderHoverColor,"slider-size":e.sliderSize,"range-color":e.rangeColor,"range-active-color":e.rangeActiveColor},null,8,["modelValue","min","max","slider-color","slider-border-color","slider-hover-color","slider-size","range-color","range-active-color"])]))}}),[["__scopeId","data-v-ed8a03ee"]])});
